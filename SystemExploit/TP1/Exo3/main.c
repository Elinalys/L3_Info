#include <stdlib.h>
#include <stdio.h>
#define TAILLE_MEMOIRE = 500

typedef struct bloc
{
	struct bloc *suivant;
	struct bloc *precedent;
	int taille;
	short flag_alloue;
} bloc;

bloc *allocationMemoire(bloc *b, int t, int taille_alloc) {
	bloc *premier = b;
	int s = 0;
	while ((b->taille)*t > taille_alloc) {
		while (b->flag_alloue == 1 && b != NULL) {
			b = b->suivant;
		}
		if (b == NULL) {
			exit(EXIT_FAILURE);
		}
		b->flag_alloue = 1;
		taille_alloc = taille_alloc - (b->taille)*t;
		b = b->suivant;
	}
	bloc *nouveau;
	b->flag_alloue = 1;
	b->taille=ceil(taille_alloc/t);
	nouveau->precedent = b;
	nouveau->suivant = b->suivant;
	b->suivant = nouveau;
	nouveau->taille = ((b->taille)*t-taille_alloc)/t;
	nouveau->flag_alloue = 0;
	return premier;
}

void liberationMemoire(bloc *premier, bloc *alloue) {
	int libre = 0;
	int alloc = 0;
	alloue->flag_alloue = 0;
	bloc *courant = premier;
	while (courant->suivant != NULL) {
		if (courant->flag_alloue = 0) {
			libre += libre + courant->taille;
			courant->precedent->suivant = courant->suivant;
			courant->suivant->precedent = courant->precedent;
			if (courant == premier) {
				premier = courant->suivant;
			}
			libre += courant->taille;
		}
		premier->precedent = NULL;
		premier->taille = alloc;
		premier->flag_alloue = 1;
		bloc *nouveau;
		nouveau->precedent = premier;
		nouveau->suivant=NULL;
		nouveau->flag_alloue = 0;
		nouveau->taille = libre;
		premier->suivant = premier;
	}
}

void associeBlocs(bloc *blocs, bloc *source, bloc *destination) {
	if (source->taille != 1) {
		exit(EXIT_FAILURE);
	}
	else if (source->flag_alloue != 1 || destination->flag_alloue != 1) {
		exit(EXIT_FAILURE);
	}
	else {
		source = destination;
	}
}

int main(int argc, char const *argv[]) {
	bloc test, test2;



	return 0;
}

